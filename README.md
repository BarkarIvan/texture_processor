# Texture Atlas Editor

Приложение на PySide6 для нарезки масок из исходных текстур и сборки их в атлас с точным масштабом. Dark theme по умолчанию.

![Texture Atlas Editor](Images/tp_preview.png)

## Возможности
- Импорт: все изображения (png/jpg/jpeg/tga/bmp) выбранной папки попадают в список.
- Маски:
  - Polygon — произвольная форма; Rect — прямоугольник с превью, Shift = квадрат.
  - Set Scale — два клика задают длину отрезка (по умолчанию 1 м, можно менять); ширина маски пересчитывается.
  - Редактирование: вставка точки через контекстное меню полигона, перемещение всей маски за заливку, снап сегментов по Shift к оси/диагонали, Undo/Redo.
  - Несколько масок на одну текстуру — каждая становится отдельным элементом атласа.
- Масштаб/качество:
  - Плотность атласа (px/m) с прогрессом пересборки.
  - Ресэмплеры: Lanczos, Kaiser (beta/radius), Pixel (Nearest). Kaiser экспериментальный; Pixel отключает сглаживание и снапает позиции к целым пикселям.
  - Экспорт: PNG с прозрачным фоном, без сетки/бордера/selection. Опциональный mip flood по маске (цвет заполняется мипами, альфа не трогается); уровни авто или вручную.
- Канвас:
  - Перемещение/выделение, косметические маркеры/линии (не растут при зуме).
  - Сетка по плотности, убирается при экспорте; позиции элементов сохраняются в проекте.
  - Дубликат элемента: кнопка Duplicate клонирует выбранные элементы (маска копируется и может редактироваться отдельно).

## Воркфлоу
1) Открыть папку с изображениями — они появятся в списке слева.
2) Выбрать текстуру, нарисовать маску (Polygon/Rect).
3) (Опционально) Задать отрезок в метрах: Set Scale, два клика по текстуре. Маска получит реальную ширину автоматически.
4) Apply Mask — маска добавится на атлас как отдельный элемент. Можно дублировать выделенные элементы (Duplicate) и редактировать их маски отдельно.
5) Двигайте элементы на канвасе; позиции сохраняются.
6) Настройте Atlas Density и Resample Settings (Lanczos/Kaiser/Pixel) — пересборка с прогрессом. В Pixel-режиме позиции снапаются к целым пикселям.
7) Экспорт PNG или сохраните проект (JSON) — при загрузке восстановятся маски, позиции, плотность, ресэмплер и настройки mip flood.

## Установка
```bash
python -m venv .venv
.venv\Scripts\activate  # Windows
pip install -r requirements.txt
```

## Запуск
```bash
.venv\Scripts\python main.py
```

## Формат проекта
- JSON хранит: textures (points, real_width, original_width, px_per_meter, mask_id), items (позиции), настройки атласа (density/size), resample, mip_flood.
- Старые проекты с одиночной маской автоматически конвертируются в формат masks[].

## Подсказки по интерфейсу
- Toolbar: Atlas Density (Enter для применения), Grid, Resample, Duplicate, Export, Mip Flood (checkbox + Levels, 0 = авто).
- Редактор: Polygon/Rect, Set Scale, Apply/Clear, Undo/Redo, Insert Point через контекстное меню.

## Зависимости
- PySide6
- Pillow
- numpy
