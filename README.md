# Texture Atlas Editor

Приложение на PySide6 для нарезки масок из исходных текстур и сборки их в атлас с точным масштабом. Dark theme по умолчанию.

![Texture Atlas Editor](Images/screenshot.png)

## Возможности
- Импорт: все изображения (png/jpg/jpeg/tga/bmp) выбранной папки попадают в список.
- Маски:
  - Polygon — произвольная форма; Rect — прямоугольник с превью, Shift = квадрат.
  - Set Scale — два клика задают длину отрезка (по умолчанию 1 м, значение можно менять); ширина маски пересчитывается.
  - Редактирование: вставка точки через контекстное меню полигона, перемещение всей маски за заливку, снап сегментов по Shift к оси/диагонали, Undo/Redo.
  - Несколько масок на одну текстуру — каждая становится отдельным элементом атласа.
- Масштаб/качество:
  - Плотность атласа (px/m) с прогрессом пересборки.
  - Ресэмплеры: Lanczos, Kaiser (beta/radius), Pixel (Nearest). Kaiser экспериментальный; Pixel отключает сглаживание и снапает позиции к целым пикселям.
  - Дубликат элемента: кнопка Duplicate клонирует выбранные элементы с новым mask_id.
- Канвас:
  - Перемещение/выделение, косметические маркеры/линии (не растут при зуме).
  - Сетка по плотности, убирается при экспорте; позиции элементов сохраняются в проекте.
- Экспорт: PNG с прозрачным фоном без сетки/бордера/selection.

## Воркфлоу
1) Откройте папку с изображениями — они появятся слева.
2) Выберите текстуру, нарисуйте маску (Polygon/Rect).
3) (Опционально) Set Scale — задайте отрезок в метрах, маска получит реальную ширину.
4) Apply Mask — маска появится на атласе; повторите для других. Можно дублировать элементы кнопкой Duplicate.
5) При необходимости двигайте элементы на канвасе; позиции сохраняются.
6) Настройте Atlas Density и Resample Settings (Lanczos/Kaiser/Pixel) — пересборка с прогрессом.
7) Экспорт PNG или сохранение проекта (JSON) — при загрузке восстановятся маски, позиции, плотность и ресэмплер.

## Установка
```bash
python -m venv .venv
.venv\Scripts\activate  # Windows
pip install -r requirements.txt
```

## Запуск
```bash
.venv\Scripts\python main.py
```

## Формат проекта
- JSON хранит: textures (points, real_width, original_width, px_per_meter, mask_id), items (позиции), настройки атласа (density/size) и ресэмплер.
- Старые проекты с одиночной маской автоматически конвертируются в формат masks[].

## Подсказки по интерфейсу
- Toolbar: Atlas Density (Enter для применения), Grid, Resample, Duplicate, Export.
- Редактор: Polygon/Rect, Set Scale, Apply/Clear, Undo/Redo, Insert Point через контекстное меню.

## Зависимости
- PySide6
- Pillow
- numpy
