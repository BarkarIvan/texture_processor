# Texture Atlas Editor

Приложение на PySide6 для нарезки масок из исходных текстур и сборки их в атлас с точным масштабом по реальным размерам.

Desktop tool (PySide6) for cutting masks out of source textures and assembling them into an atlas with precise real‑world scaling.

## Возможности
- Импорт: при выборе папки в левом списке появляются все изображения (png/jpg/jpeg/tga/bmp).
- Маски:
  - Polygon — произвольная форма.
  - Rect — прямоугольник с превью при движении мыши; Shift = квадрат.
  - Set 1m — два клика задают, сколько пикселей равно 1 метру для этой текстуры; ширина маски пересчитывается автоматически.
  - Несколько масок на одну текстуру: каждая маска становится отдельным элементом на атласе.
- Масштаб/качество:
  - Плотность атласа (px/m) с пересборкой и прогрессом.
  - Ресэмплер: Lanczos или Kaiser (beta/radius), кеширование.
- Канвас:
  - Перемещение/выделение элементов, маркеры/линии косметические (не растут при зуме).
  - Сетка с шагом = плотности, убирается при экспорте; позиции элементов сохраняются в проекте.
- Экспорт: PNG с прозрачным фоном, без сетки/бордера/selection.

## Воркфлоу
1) Открыть папку с изображениями — они появятся в списке слева.
2) Выбрать текстуру → в редакторе нарисовать маску (Polygon или Rect с превью).
3) (Опционально) Задать эталон 1 м: кнопка Set 1m, два клика по текстуре. Маска получает реальную ширину автоматически.
4) Нажать Apply Mask — маска добавится на атлас как отдельный элемент. Повторить для остальных масок/текстур.
5) При необходимости подвинуть элементы на канвасе; позиции сохранятся.
6) Настроить Atlas Density и Resample Settings (Lanczos/Kaiser) — пересборка с прогрессом.
7) Экспортировать PNG или сохранить проект (JSON), чтобы вернуться позже. При загрузке проекта восстанавливаются все маски, позиции элементов, плотность атласа и настройки ресэмплера.

## Установка
```bash
python -m venv .venv
.venv\Scripts\activate  # Windows
pip install -r requirements.txt
```

## Запуск
```bash
.venv\Scripts\python main.py
```

## Работа с проектами
- Сохранение/загрузка: JSON хранит пути текстур, маски (points, real_width, original_width, px_per_meter, mask_id), позиции элементов, настройки атласа (density/size) и ресэмплера.
- При загрузке старого формата одиночная маска автоматически приводится к новому виду (masks[]).

## Подсказки по интерфейсу
- Toolbar:
  - Atlas Density — вводите значение и жмите Enter (пересборка с прогрессом).
  - Show Grid — включает/выключает сетку.
  - Export PNG — сохранение финального атласа.
  - Resample Settings — выбор Lanczos/Kaiser, beta/radius.
- Редактор:
  - Polygon / Rect — выбор инструмента маски.
  - Set 1m — два клика задают 1 метр; линия пурпурная.
  - Apply Mask — создаёт/обновляет маску и элемент на атласе.
  - Clear Mask — сброс текущей маски.

## Зависимости
- PySide6
- Pillow
- numpy
